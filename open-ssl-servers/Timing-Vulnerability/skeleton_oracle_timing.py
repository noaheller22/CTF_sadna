#!/usr/bin/env python3
import argparse
import socket
import base64

# Config
PROXY_HOST = ""  
PROXY_PORT = 0                  

def main():
    parser = argparse.ArgumentParser()
    parser.add_argument("ciphertext_b64", help="RSA ciphertext in base64")
    args = parser.parse_args()

    ciphertext_b64 = args.ciphertext_b64.strip()

    # Connect
    sock = socket.create_connection((PROXY_HOST, PROXY_PORT))

    # Send the ciphertext
    sock.sendall(ciphertext_b64.encode() + b"\n")

    # Receive and print everything
    try:
        while True:
            data = sock.recv(4096)
            if not data:
                break
            print(data.decode(errors="replace"), end="")
    finally:
        sock.close()

if __name__ == "__main__":
    main()
