"Here is a helper function you can use in order to analyz the servers behavior"


import socket, binascii, time

def measure(cipher_hex, trials=5, host, port):
    """Send the same ciphertext multiple times and average response time."""
    ciphertext = binascii.unhexlify(cipher_hex.strip())
    times = []
    for _ in range(trials):
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((host, port))
        t0 = time.perf_counter()
        s.sendall(ciphertext)
        _ = s.recv(4096)   # ignore response
        t1 = time.perf_counter()
        s.close()
        times.append(t1 - t0)
    return sum(times) / len(times)
